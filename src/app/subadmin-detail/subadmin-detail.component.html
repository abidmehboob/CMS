<div class="pcoded-main-container">
    <div class="pcoded-wrapper">
        <app-sidebar></app-sidebar>
        <div class="pcoded-content bg-white">
            <div class="pcoded-inner-content">
                <!-- Main-body start -->
                <div class="main-body">
                    <div class="page-wrapper pb-0">
                        <!-- Page-header start -->
                        <div class="page-header card bg-transparent box-shadow-none">
                            <div class="row align-items-end">
                                <div class="col-lg-8">
                                    <div class="page-header-title">
                                        <div class="d-inline">
                                            <h4 class="mt-3">Manage Employees <span class="dot"></span> <small
                                                    class="dot-number">{{this.rows ? this.rows.length : ""}}
                                                </small>
                                            </h4>
                                        </div>
                                    </div>
                                </div>
                                <button (click)="cm()" data-toggle="modal" data-target="#createModal"
                                    class="btn btn-round btn-warning btn-outline-warning btn-orange">CREATE
                                    EMPLOYEE</button>
                            </div>
                        </div>
                    </div>
                    <!-- Page-header end -->
                    <!-- Page-body start -->
                    <div class="page-wrapper pt-0">
                        <!-- Basic table card start -->
                        <input type="text" class="form-control col-lg-4 "
                            placeholder="Type to filter the name column..." (keyup)="updateFilter($event)" />
                        <p>&nbsp; </p>
                        <div class="card">
                            <div class="card-block table-border-style p-3 pt-4">
                                <div class="table-responsive">
                                    <ngx-spinner bdColor = "rgba(0, 0, 0, 0.8)" size = "default" color = "#fff" type = "ball-beat" [fullScreen] = "false"><p style="color: white;"> Loading... </p></ngx-spinner>                                    

                                    <ngx-datatable #myTable class="dark" [rows]="rows" [columnMode]="'force'"
                                        [headerHeight]="50" [footerHeight]="50" [rowHeight]="120" [scrollbarH]="true"
                                        [sorts]="[{prop: 'email', dir: 'desc'}]">
                                        <!-- [externalPaging]="true"
                                        [offset]="page.pageNumber"
                                        [limit]="page.size"
                                        
                                        [count]="12"
                                        (page)="setPage($event)"> -->


                                        <ngx-datatable-column name="Name">
                                            <ng-template let-row="row" ngx-datatable-cell-template>
                                                {{row.name}}                                            </ng-template>
                                        </ngx-datatable-column>
                                        <ngx-datatable-column name="Email">
                                            <ng-template let-row="row" ngx-datatable-cell-template>
                                                {{row.email}}
                                            </ng-template>
                                        </ngx-datatable-column>
                                        <ngx-datatable-column name="Phone">
                                            <ng-template let-row="row" ngx-datatable-cell-template>
                                                {{row.phone}}
                                            </ng-template>
                                        </ngx-datatable-column>
                                        <ngx-datatable-column name="Action">
                                            <ng-template let-row="row" let-rowIndex="rowIndex" ngx-datatable-cell-template>
                                                <a href="" class="action-btn" [routerLink]="[]"
                                                    (click)="editForm(row.employee_id, rowIndex)" data-toggle="modal"
                                                    data-target="#createModal"><i class="fa fa-edit"></i></a>
                                                &nbsp;
                                                <a class="action-btn" [routerLink]="[]" (click)="deleteForm(row.employee_id)"
                                                    data-toggle="modal" data-target="#deleteModal"><i
                                                        class="fa fa-trash"></i></a>
                                            </ng-template>
                                        </ngx-datatable-column>
                                        <ngx-datatable-footer>
                                            <ng-template 
                                              ngx-datatable-footer-template
                                              let-rowCount="rowCount"
                                              let-pageSize="pageSize"
                                              let-selectedCount="selectedCount"
                                              let-curPage="curPage"
                                              let-offset="offset"
                                              let-isVisible="isVisible">
                                                <div class="page-count">
                                                </div>
                                                <datatable-pager
                                                    [pagerLeftArrowIcon]="'datatable-icon-left'"
                                                    [pagerRightArrowIcon]="'datatable-icon-right'"
                                                    [pagerPreviousIcon]="'datatable-icon-prev'"
                                                    [pagerNextIcon]="'datatable-icon-skip'"
                                                    [page]="1"
                                                    [size]="perPage"
                                                    [count]="totalElements"
                                                    [hidden]="!((totalElements / perPage) > 1)"
                                                    (change)="pageChange($event)">
                                                </datatable-pager>
                                            </ng-template>
                                          </ngx-datatable-footer>

                                    </ngx-datatable>
                                    <!-- <table class="table table-custom">
                                        <thead>
                                            <tr>
                                                <th>Image</th>
                                                <th>Name</th>
                                                <th>Email</th>
                                                <th>Phone</th>
                                                <th>Status</th>
                                                <th>Actions</th>
                                            </tr>
                                        </thead>
                                        <tbody>
                                            <tr *ngFor="let subadmin of this.subadmins;index as i;">
                                                <td><img src="{{imageUrl+subadmin.profilePicture}}" height="100px"
                                                        width="100px" /></td>
                                                <td>{{subadmin.firstName}} {{subadmin.lastName}}</td>
                                                <td>{{subadmin.email}}</td>
                                                <td>{{subadmin.phoneNumber}}</td>
                                                <td>
                                                    <label class="switch">
                                                        <input type="checkbox" [checked]="subadmin.status==='active'"
                                                            (change)="changeStatus(subadmin._id, $event)">
                                                        <span class="slider round"></span>
                                                    </label>
                                                </td>
                                                <td>
                                                    <a href="javascript:;" class="action-btn"
                                                        (click)="editForm(subadmin._id, i)" data-toggle="modal"
                                                        data-target="#editModal"><i class="fa fa-edit"></i></a>
                                                    &nbsp;
                                                    <a [routerLink]="[]" (click)="deleteForm(subadmin._id)"
                                                        class="action-btn" data-toggle="modal"
                                                        data-target="#deleteModal">
                                                        <i class="fa fa-trash"></i></a>
                                                </td>
                                            </tr>
                                            <tr *ngIf="!subadmins.length">
                                                <td colspan="10" class="text-center">No record found</td>
                                            </tr>
                                        </tbody>
                                    </table> -->
                                </div>
                            </div>
                        </div>
                        <!-- Basic table card end -->
                    </div>
                    <!-- Page-body end -->
                </div>
            </div>
            <!-- Main-body end -->

            <div id="styleSelector">

            </div>
        </div>
    </div>
</div>

<div class="modal fade" id="createModal" role="dialog">
    <div class="modal-dialog modal-lg">

        <!-- Modal content-->
        <div class="modal-content">
            <div class="modal-header">
                <button type="button" class="close" data-dismiss="modal">&times;</button>
                <h4 class="modal-title text-center">{{action}} Employee</h4>
            </div>
            <div class="modal-body">
                <div class="form-group ">
                        <label>Name</label>
                        <input type="text" class="form-control" name="name" id="name" [(ngModel)]="name">
                </div>
                <div class="form-group">
                    <label>Email</label>
                    <input type="email" class="form-control" name="email" id="email" [(ngModel)]="email">
                </div>
                <div class="form-group">
                    <label>Phone Number</label>
                    <input type="text" class="form-control" name="phoneNumber" id="phoneNumber"
                        [(ngModel)]="phoneNumber">
                </div>
                <div class="form-group" >
                    <label>Role</label>
                    <select class="form-control" name="role_id" id="role_id"
                    [(ngModel)]="role_id" >
                            <option value="0" >Select role</option>
                            <ng-container *ngFor="let role of roles" >
                                <ng-container *ngIf="adminType == 1 && role.id !=  1"> 
                                <option   value="{{role.id}}"  >  
                                        {{role.name}}
                                </option>
                            </ng-container>
                            <ng-container *ngIf="adminType == 0"> 
                                <option   value="{{role.id}}"  >  
                                        {{role.name}}
                                </option>
                            </ng-container>
    
                            </ng-container>
                    </select>
                </div>
                <div class="form-group"  *ngIf="role_id == '3' || role_id == '5'" >
                    <div class="" >
                        <label>Hotel</label>
                        <select name="hotel_id" id="hotel_id" [(ngModel)]="hotel_id" class="form-control" >
                            <option value="" >Select Hotel</option>
                                
                            <ng-container *ngFor="let hotel of hotels" >
                                <option value="{{hotel.hotel_id}}" >
{{hotel.name}}
                                </option>
    
                            </ng-container>

                        </select>
    
                    </div>

                </div>
                <div   *ngIf="mode === 1" class="form-group row">
                    <div class="col-lg-6">
                        <label>Password</label>
                        <input type="password" class="form-control" name="password" id="password"
                            [(ngModel)]="password">
                    </div>
                    <div class="col-lg-6">
                        <label>Confirm Password</label>
                        <input type="password" class="form-control" name="confirmPassword" id="confirmPassword"
                            [(ngModel)]="confirmPassword">
                    </div>
                </div>
                <div class="form-group" style="display: none;" >
                    <label>
                        Profile Picture
                    </label>
                    <div class="form-group ">
                        <input class="form-c" type="file" name="image" (change)="fileProgress($event)" />
                    </div>
                    <div *ngIf="fileUploadProgress">
                        Upload progress: {{ fileUploadProgress }}
                    </div>
                    <div class="col-12 col-sm-12 col-md-12 mt-3" class="img_wrp" *ngIf="previewUrl">
                        <img [src]="previewUrl" height="80" width="100"/>
                        <span (click)="cancel()" class="close" style="color:darkblue;">
                            <i class="fas fa-times"></i>
                        </span>
                    </div>
                </div>
                <!--
                <div class="form-group">
                    <label>Permissions</label>
                    <div>
                        <input type="checkbox" name="dashboard" [(ngModel)]="permissions.dashboard">
                        <label class="form-check-label">Dashboard</label>
                    </div>
                    <div>
                        <input type="checkbox" name="customers" [(ngModel)]="permissions.customers">
                        <label class="form-check-label">Manage Customers</label>
                    </div>
                    <div>
                        <input type="checkbox" name="subadmins" [(ngModel)]="permissions.subadmins">
                        <label class="form-check-label">Manage Subadmins</label>
                    </div>
                    <div>
                        <input type="checkbox" name="listings" [(ngModel)]="permissions.listings">
                        <label class="form-check-label">Manage Listings</label>
                    </div>
                    <div>
                        <input type="checkbox" name="events" [(ngModel)]="permissions.events">
                        <label class="form-check-label">Manage Events</label>
                    </div>
                    <div>
                        <input type="checkbox" name="faqs" [(ngModel)]="permissions.faqs">
                        <label class="form-check-label">Manage Faqs</label>
                    </div>
                    <div>
                        <input type="checkbox" name="makes" [(ngModel)]="permissions.makes">
                        <label class="form-check-label">Manage Makes</label>
                    </div>
                    <div>
                        <input type="checkbox" name="models" [(ngModel)]="permissions.models">
                        <label class="form-check-label">Manage Models</label>
                    </div>
                    <div>
                        <input type="checkbox" name="banners" [(ngModel)]="permissions.banners">
                        <label class="form-check-label">Manage Banners</label>
                    </div>
                    <div>
                        <input type="checkbox" name="contactus" [(ngModel)]="permissions.contactus">
                        <label class="form-check-label">Contact Us</label>
                    </div>
                    <div>
                        <input type="checkbox" name="categories" [(ngModel)]="permissions.categories">
                        <label class="form-check-label">Manage Categories</label>
                    </div>
                    <div>
                        <input type="checkbox" name="subcategories" [(ngModel)]="permissions.subcategories">
                        <label class="form-check-label">Manage Subcategories</label>
                    </div>
                    <div>
                        <input type="checkbox" name="childSubcategories" [(ngModel)]="permissions.childSubcategories">
                        <label class="form-check-label">Manage Child Subcategories</label>
                    </div>
                    <div>
                        <input type="checkbox" name="socialLinks" [(ngModel)]="permissions.socialLinks">
                        <label class="form-check-label">Manage Social Links</label>
                    </div>
                    <div>
                        <input type="checkbox" name="content" [(ngModel)]="permissions.content">
                        <label class="form-check-label">Manage Content</label>
                    </div>
                    <div>
                        <input type="checkbox" name="subscriptions" [(ngModel)]="permissions.subscriptions">
                        <label class="form-check-label">Manage Subscriptions</label>
                    </div>
                    <div>
                        <input type="checkbox" name="reporting" [(ngModel)]="permissions.reporting">
                        <label class="form-check-label">Reporting</label>
                    </div>
                    <div>
                        <input type="checkbox" name="settings" [(ngModel)]="permissions.settings">
                        <label class="form-check-label">Settings</label>
                    </div>
                </div> -->
            </div>
            <div class="modal-footer">
                <button type="button" [disabled]="saveDisabled" class="btn btn-outline-warning" (click)="createSubadmin()">{{btn}} &nbsp; <span *ngIf="saveDisabled" class="pcoded-micon"><i class="ti-reload rotate-refresh"></i></span></button>
                <button type="button" class="btn btn-default" data-dismiss="modal">Close</button>
            </div>
        </div>
    </div>
</div>
<div id="deleteModal" class="modal fade">
    <div class="modal-dialog modal-confirm">
        <div class="modal-content">
            <div class="modal-header">
                <h4 class="modal-title">Are you sure?</h4>
                <button type="button" class="close" data-dismiss="modal" aria-hidden="true">&times;</button>
            </div>
            <div class="modal-body">
                <p>Do you really want to delete these records? This process cannot be undone.</p>
            </div>
            <div class="modal-footer">
                <button type="button" class="btn btn-default" data-dismiss="modal">Cancel</button>
                <button type="button" class="btn btn-danger" (click)="deleteSubadmin()">Delete</button>
            </div>
        </div>
    </div>
</div>

<div class="modal fade" id="editModal" role="dialog" aria-modal="true">
    <div class="modal-dialog modal-lg">

        <!-- Modal content-->
        <div class="modal-content">
            <div class="modal-header">
                <button type="button" class="close" data-dismiss="modal">&times;</button>
                <h4 class="modal-title text-center">Edit Subadmin</h4>
            </div>
            <div class="modal-body">
                <div class="form-group row">
                    <div class="col-lg-6">
                        <label>First Name</label>
                        <input type="text" class="form-control" name="firstNameE" id="firstNameE"
                            [(ngModel)]="firstNameE">
                    </div>
                    <div class="col-lg-6">
                        <label>Last Name</label>
                        <input type="text" class="form-control" name="lastNameE" id="lastNameE" [(ngModel)]="lastNameE">
                    </div>
                </div>
                <div class="form-group">
                    <label>Email</label>
                    <input type="email" class="form-control" name="emailE" id="emailE" [(ngModel)]="emailE">
                </div>
                <div class="form-group">
                    <label>Mobile Number</label>
                    <input type="text" class="form-control" name="phoneNumberE" id="phoneNumberE"
                        [(ngModel)]="phoneNumberE">
                </div>
                <div class="form-group">
                    <label>
                        Profile Picture
                    </label>
                    <div class="form-group " *ngIf="!previewUrlE">
                        <input class="form-c" type="file" name="imageE" (change)="fileProgress($event)" />
                    </div>
                    <div *ngIf="fileUploadProgress">
                        Upload progress: {{ fileUploadProgress }}
                    </div>
                    <div class="col-12 col-sm-12 col-md-12 mt-3" *ngIf="previewUrlE">
                        <img [src]="previewUrlE" height="80" width="100"/> &nbsp; &nbsp;
                        <span (click)="removeImg()" style="color:orange">Change image</span>
                    </div>
                    <div class="form-group">
                        <label>Permissions</label>
                        <div>
                            <input type="checkbox" name="dashboard" [(ngModel)]="permissionsE.dashboard">
                            <label class="form-check-label">Dashboard</label>
                        </div>
                        <div>
                            <input type="checkbox" name="customers" [(ngModel)]="permissionsE.customers">
                            <label class="form-check-label">Manage Customers</label>
                        </div>
                        <div>
                            <input type="checkbox" name="subadmins" [(ngModel)]="permissionsE.subadmins">
                            <label class="form-check-label">Manage Subadmins</label>
                        </div>
                        <div>
                            <input type="checkbox" name="listings" [(ngModel)]="permissionsE.listings">
                            <label class="form-check-label">Manage Listings</label>
                        </div>
                        <div>
                            <input type="checkbox" name="events" [(ngModel)]="permissionsE.events">
                            <label class="form-check-label">Manage Events</label>
                        </div>
                        <div>
                            <input type="checkbox" name="faqs" [(ngModel)]="permissionsE.faqs">
                            <label class="form-check-label">Manage Faqs</label>
                        </div>
                        <div>
                            <input type="checkbox" name="makes" [(ngModel)]="permissionsE.makes">
                            <label class="form-check-label">Manage Makes</label>
                        </div>
                        <div>
                            <input type="checkbox" name="models" [(ngModel)]="permissionsE.models">
                            <label class="form-check-label">Manage Models</label>
                        </div>
                        <div>
                            <input type="checkbox" name="banners" [(ngModel)]="permissionsE.banners">
                            <label class="form-check-label">Manage Banners</label>
                        </div>
                        <div>
                            <input type="checkbox" name="contactus" [(ngModel)]="permissionsE.contactus">
                            <label class="form-check-label">Contact Us</label>
                        </div>
                        <div>
                            <input type="checkbox" name="categories" [(ngModel)]="permissionsE.categories">
                            <label class="form-check-label">Manage Categories</label>
                        </div>
                        <div>
                            <input type="checkbox" name="subcategories" [(ngModel)]="permissionsE.subcategories">
                            <label class="form-check-label">Manage Subcategories</label>
                        </div>
                        <div>
                            <input type="checkbox" name="childSubcategories" [(ngModel)]="permissionsE.childSubcategories">
                            <label class="form-check-label">Manage Child Subcategories</label>
                        </div>
                        <div>
                            <input type="checkbox" name="socialLinks" [(ngModel)]="permissionsE.socialLinks">
                            <label class="form-check-label">Manage Social Links</label>
                        </div>
                        <div>
                            <input type="checkbox" name="content" [(ngModel)]="permissionsE.content">
                            <label class="form-check-label">Manage Content</label>
                        </div>
                        <div>
                            <input type="checkbox" name="subscriptions" [(ngModel)]="permissionsE.subscriptions">
                            <label class="form-check-label">Manage Subscriptions</label>
                        </div>
                        <div>
                            <input type="checkbox" name="reporting" [(ngModel)]="permissionsE.reporting">
                            <label class="form-check-label">Reporting</label>
                        </div>
                        <div>
                            <input type="checkbox" name="settings" [(ngModel)]="permissionsE.settings">
                            <label class="form-check-label">Settings</label>
                        </div>
                    </div>
                </div>
            </div>
            <div class="modal-footer">
                <button type="button" class="btn btn-outline-warning" (click)="onSubmitEdit()">Submit</button>
                <button type="button" class="btn btn-default" data-dismiss="modal">Close</button>
            </div>
        </div>
    </div>
</div>